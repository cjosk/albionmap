<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albion Online - Lonca Haritası</title>

    <!-- Leaflet.js Kütüphanesi (CSS ve JS) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>

    <style>
        /* Sayfanın tamamını kaplaması için temel stiller */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; /* Harita arkasındaki koyu renk */
            font-family: Arial, sans-serif;
        }
        /* Harita konteynerinin stilini belirleme */
        #map {
            width: 100%;
            height: 100%;
            background-color: #333; /* Harita yüklenirken görünecek renk */
        }
        /* Leaflet pop-up pencerelerinin daha okunaklı olması için stil */
        .leaflet-popup-content-wrapper {
            background-color: #2c3e50;
            color: #ecf0f1;
            border-radius: 8px;
            box-shadow: 0 3px 14px rgba(0,0,0,0.4);
        }
        .leaflet-popup-content {
            font-size: 14px;
        }
        .leaflet-popup-tip {
            background: #2c3e50;
        }
        .leaflet-popup-close-button {
            color: #ecf0f1 !important;
        }
        /* Katman kontrol kutusunun stili */
        .leaflet-control-layers {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <!-- Haritanın gösterileceği HTML elementi -->
    <div id="map"></div>

    <script>
        // --- HARİTA AYARLARI ---

        // Leaflet'in coğrafi olmayan haritalar için basit koordinat sistemini kullanıyoruz.
        const map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: 4,
            maxZoom: 4,
            zoomControl: true 
        });

        const imageWidth = 4096;
        const imageHeight = 4096;
        
        const bounds = [[0, 0], [imageHeight, imageWidth]];

        // Döşeme katmanını (Tile Layer) oluşturuyoruz.
        const tileLayer = L.tileLayer('maptiles/map_{x}_{y}.png', {
            bounds: bounds,
            // tms: true, // BU SATIR KALDIRILDI! Dosya adlarınız standart Y ekseni kullandığı için bu ayar hatalı koordinatlara yol açıyordu.
            noWrap: true // Haritanın yatayda tekrarlanmasını engeller
        });

        tileLayer.on('tileerror', function(error, tile) {
            console.error('Harita parçası yüklenemedi. Dosya yolu doğru mu?:', error.tile.src);
        });

        tileLayer.addTo(map);
        
        // Haritanın merkezini ve başlangıç zoom seviyesini ayarlıyoruz.
        map.setView([2048, 2048], 4);
        
        // Kullanıcının harita sınırları dışına çıkmasını engelliyoruz.
        map.setMaxBounds(bounds);


        // --- VERİ GİRİŞİ (BURAYI KENDİNİZE GÖRE DÜZENLEYİN) ---

        // Sığınaklarınız (Hideouts) için özel bir ikon oluşturalım.
        const hideoutIcon = L.icon({
            iconUrl: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjM2E5OWQ0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEwIDIwdi02aDR2Nmg1di04aDNMMTIgM2wtOSA5aDN2OGg1eiIvPjwvc3ZnPg==', // Mavi ev ikonu (Base64 SVG)
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -32]
        });

        // Bölgeleriniz (Territories) için özel bir ikon oluşturalım.
        const territoryIcon = L.icon({
            iconUrl: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjZWM3NzRjIj48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyIDE3LjI3TDE4LjE4IDIyIDE2LjU0IDE0LjgxIDEyIDEwLjMyIDcuNDYgMTQuODEgNS44MiAyMiIvPjwvc3ZnPg==', // Turuncu yıldız ikonu (Base64 SVG)
            iconSize: [32, 32],
            iconAnchor: [16, 16],
            popupAnchor: [0, -16]
        });


        // Loncanızın sığınaklarının listesi.
        // `coords`: Harita üzerindeki [y, x] koordinatı.
        // `name`: İkonun üzerine tıklandığında görünecek başlık.
        // `description`: Açıklama metni.
        const myHideouts = [
            {
                coords: [2100, 2200], // Örnek koordinat. Doğrusunu haritaya tıklayarak konsoldan öğrenin!
                name: "InTheEnd",
                description: "T8 Hideout"
            }
        ];

        // Loncanızın bölgelerinin listesi.
        const myTerritories = [
            {
                coords: [2350, 2050], // Örnek koordinat
                name: "Yeşilvadi Çiftliği",
                description: "T5 Fiber Bölgesi. Saatlik üretim: 500 Siphoned Energy."
            },
            {
                coords: [850, 1250], // Örnek koordinat
                name: "Kuzey Gözcü Kulesi",
                description: "T8 Maden Bölgesi. Saatlik üretim: 1200 Siphoned Energy."
            }
        ];


        // --- İKONLARI HARİTAYA EKLEME ---

        // Katman grupları oluşturuyoruz. Bu sayede kullanıcı ikonları açıp kapatabilir.
        const hideoutLayer = L.layerGroup();
        const territoryLayer = L.layerGroup();

        // Sığınakları haritaya ekle
        myHideouts.forEach(ho => {
            L.marker(ho.coords, {icon: hideoutIcon})
             .bindPopup(`<b>${ho.name}</b><br>${ho.description}`)
             .addTo(hideoutLayer);
        });

        // Bölgeleri haritaya ekle
        myTerritories.forEach(terry => {
            L.marker(terry.coords, {icon: territoryIcon})
             .bindPopup(`<b>${terry.name}</b><br>${terry.description}`)
             .addTo(territoryLayer);
        });
        
        // Katmanları varsayılan olarak haritaya ekliyoruz.
        hideoutLayer.addTo(map);
        territoryLayer.addTo(map);

        // Kullanıcının haritada neleri göreceğini seçebileceği kontrol kutusu
        const overlayMaps = {
            "Sığınaklar (Hideouts)": hideoutLayer,
            "Bölgeler (Territories)": territoryLayer
        };

        L.control.layers(null, overlayMaps, { collapsed: false }).addTo(map);

        // Haritada bir yere tıklandığında koordinatları konsola yazdırma (opsiyonel, koordinat bulmak için faydalı)
        map.on('click', function(e) {
            console.log("Harita Koordinatı: [" + e.latlng.lat + ", " + e.latlng.lng + "]");
        });

    </script>
</body>
</html>

