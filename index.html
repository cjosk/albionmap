<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albion Online - Lonca Haritası</title>

    <!-- Leaflet.js Kütüphanesi (CSS ve JS) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>

    <style>
        /* Sayfanın tamamını kaplaması için temel stiller */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; /* Harita arkasındaki koyu renk */
            font-family: Arial, sans-serif;
        }
        /* Harita konteynerinin stilini belirleme */
        #map {
            width: 100%;
            height: 100%;
            background-color: #333; /* Harita yüklenirken görünecek renk */
        }
        /* Leaflet pop-up pencerelerinin daha okunaklı olması için stil */
        .leaflet-popup-content-wrapper {
            background-color: #2c3e50;
            color: #ecf0f1;
            border-radius: 8px;
            box-shadow: 0 3px 14px rgba(0,0,0,0.4);
        }
        .leaflet-popup-content {
            font-size: 14px;
        }
        .leaflet-popup-tip {
            background: #2c3e50;
        }
        .leaflet-popup-close-button {
            color: #ecf0f1 !important;
        }
        /* Katman kontrol kutusunun stili */
        .leaflet-control-layers {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <!-- Haritanın gösterileceği HTML elementi -->
    <div id="map"></div>

    <script>
        // --- HARİTA AYARLARI ---

        // GitHub'daki klasör yapısına göre zoom seviyelerini ayarlıyoruz.
        const map = L.map('map', {
            crs: L.CRS.Simple,
            minZoom: 2,
            maxZoom: 4, // GitHub'da en yüksek seviye 4
            zoomControl: true 
        });

        // Görüntünün piksel boyutları (max zoom'a göre)
        const imageWidth = 4096;
        const imageHeight = 4096;
        const bounds = [[0, 0], [imageHeight, imageWidth]];

        // DÖŞEME KATMANI (TILE LAYER) - DÜZELTİLMİŞ KISIM
        // Yol artık GitHub'daki klasör yapısıyla uyumlu: maptiles/{z}/{x}_{y}.png
        const tileLayer = L.tileLayer('maptiles/{z}/{x}_{y}.png', {
            noWrap: true, // Haritanın yatayda tekrarlanmasını engeller
            tms: true, // Albion haritaları için genellikle bu gereklidir
        });

        tileLayer.on('tileerror', function(error, tile) {
            console.error('Harita parçası yüklenemedi. Yol doğru mu?:', error.tile.src);
        });

        tileLayer.addTo(map);
        
        // Haritayı ortalayarak ve iyi bir başlangıç zoom seviyesiyle başlatıyoruz.
        map.setView([2048, 2048], 2);
        
        // Kullanıcının harita sınırları dışına çıkmasını engelliyoruz.
        map.setMaxBounds(bounds);


        // --- VERİ GİRİŞİ (BURAYI KENDİNİZE GÖRE DÜZENLEYİN) ---

        // Sığınaklarınız (Hideouts) için özel bir ikon oluşturalım.
        const hideoutIcon = L.icon({
            iconUrl: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjM2E5OWQ0Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEwIDIwdi02aDR2Nmg1di04aDNMMTIgM2wtOSA5aDN2OGg1eiIvPjwvc3ZnPg==',
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -32]
        });

        // Bölgeleriniz (Territories) için özel bir ikon oluşturalım.
        const territoryIcon = L.icon({
            iconUrl: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjZWM3NzRjIj48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyIDE3LjI3TDE4LjE4IDIyIDE2LjU0IDE0LjgxIDEyIDEwLjMyIDcuNDYgMTQuODEgNS$.4YyAyMiIvPjwvc3ZnPg==',
            iconSize: [32, 32],
            iconAnchor: [16, 16],
            popupAnchor: [0, -16]
        });


        // Loncanızın sığınaklarının listesi.
        const myHideouts = [
            {
                coords: [2100, 2200], // Örnek koordinat
                name: "InTheEnd",
                description: "T8 Hideout"
            }
        ];

        // Loncanızın bölgelerinin listesi.
        const myTerritories = [
            {
                coords: [2350, 2050], // Örnek koordinat
                name: "Yeşilvadi Çiftliği",
                description: "T5 Fiber Bölgesi"
            }
        ];


        // --- İKONLARI HARİTAYA EKLEME ---

        const hideoutLayer = L.layerGroup();
        const territoryLayer = L.layerGroup();

        myHideouts.forEach(ho => {
            L.marker(ho.coords, {icon: hideoutIcon})
             .bindPopup(`<b>${ho.name}</b><br>${ho.description}`)
             .addTo(hideoutLayer);
        });

        myTerritories.forEach(terry => {
            L.marker(terry.coords, {icon: territoryIcon})
             .bindPopup(`<b>${terry.name}</b><br>${terry.description}`)
             .addTo(territoryLayer);
        });
        
        hideoutLayer.addTo(map);
        territoryLayer.addTo(map);

        const overlayMaps = {
            "Sığınaklar (Hideouts)": hideoutLayer,
            "Bölgeler (Territories)": territoryLayer
        };

        L.control.layers(null, overlayMaps, { collapsed: false }).addTo(map);

        map.on('click', function(e) {
            console.log(`Koordinat: [${Math.round(e.latlng.lat)}, ${Math.round(e.latlng.lng)}]`);
        });

    </script>
</body>
</html>

